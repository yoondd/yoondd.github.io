방화벽.

프로그램을 만드는것도 중요하지만 쓰게하기위해서 **배포**를 해야한다


### L4, L7.

OSI 7계층이야기.

전송계층이랑 응용계층 이야기.



---

## OSI 7계층과 L4, L7

- **OSI 7계층**: 네트워크 통신을 7단계로 나눠 설명하는 모델
    - **L4 (전송 계층)**: TCP, UDP 등 전송 계층에서 동작. IP와 포트 정보를 사용해 로드밸런싱
    - **L7 (응용 계층)**: HTTP, HTTPS 등 응용 계층에서 동작. URL, 쿠키 등 요청 내용을 보고 로드밸런싱


---


### 선생님의 설명

모든 사업을 프로그램으로 한다. 다들 인터넷에다가 배포를 한다

우리도 뭔가 필요하면, 인터넷에 검색을 한다.

어떤 회사가 사업을 했고, 서비스를 출시한다면 - 서버 한대로는 안돼. 서버 여러대 이용한다.

어떤 일을할때 한명에게 다 몰빵하면, 서버가 죽고 나서 다시 살리는 동안 마비 상태가 된다.

따라서, 일을 할때도 최소 2명은 두어야한다. 배포를 할때도 똑같은걸 2개 배포한다.

물리적인 서버를 두개 두었다는 말이다.

그럴때, 사용자에게 어디로 와야할지를 안내해야는 것이 필요하다.

이 두개의 서버 앞에 사람 하나를 두고, 그 사람이 서버 두개의 상태를 확인해서 판단 후에, 안내한다.

두 서버가 모두 바쁘다면, 대기를 시킬 수도 있다. 

그 때 이 안내자를 우리는 *로드 밸런서* 라고 표현한다.

이 안내자가 하는 로드밸런싱이라 불리는 작업이 있는데, L4까지는 하드웨어이기때문에 장비단에서 로드밸런싱을 하는 것이다. 물리적인 로드밸런싱이라고 주는 것이다.

예전에는 L4밖에 없었다. 이 장비는 아래있는 서버들의 상태를 확인(헬스체크)해야하기 때문에 비쌀 수 밖에없었다. 헬스 체크 후 괜찮으면 보내주기 때문. 너무 비싸서 임대로 쓸 정도였다

L7은, 응용계층에서 일어나는 것이다. 소프트웨어잖아. 

ip당 ping던져보고(신호 보내보고) 응답오나 안오나 체크할 수도 있잖아.

즉, L4까지 안가도 소스코드로도 해결이 되는거야.

L7은 nginx 서버로 만들어져있다. 24시간 365일 항상 켜져있어야하거든. 

L4보다는 저렴한 비용으로 그냥 써먹을 수 있으니 아주 좋겠지. 곁다리로 설치가 가능하다는거야.

로드밸런싱을위한 별도의 하드웨어가 필요하지 않다는 거야.

근데, 소스코드가 오류가 날 수도 있다는 단점은 있네. 

---


## 로드밸런서의 역할

- 여러 대의 서버 앞에 위치해, 사용자 요청을 적절한 서버로 분배
- 서버 상태(헬스 체크)를 확인해, 문제가 있는 서버는 제외하고 요청을 전달
- 서버가 모두 바쁘면 대기시키는 등 서비스의 안정성과 확장성을 높임


---

## L4 로드밸런서

- **하드웨어 기반**이 많음 (물리 장비)
- IP, 포트 단위로 요청을 분배
- 헬스 체크 등 고급 기능 제공
- **비용이 높음** (예: 한 달 2만원 수준)
- 예전에는 L4 장비만 있었고, 임대해서 쓰기도 했음

---

## L7 로드밸런서

- **소프트웨어 기반** (예: nginx, Apache)
- HTTP/HTTPS 등 응용 계층에서 동작
- URL, 쿠키 등 요청 내용을 분석해 분배
- **비용이 저렴함** (예: 한 달 500원 수준)
- 별도의 하드웨어 없이 설치 가능
- 소스코드 오류 등 소프트웨어적 이슈가 있을 수 있음

---


우리도 배포를 할때, L4와 L7중에 하나로 배포를 해야한다.




