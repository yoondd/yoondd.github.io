수업일자: 2025-05-13

## 👍🏻 GCP를 이용했던 절차 다시 정리해보기

![](https://i.imgur.com/A7KxIJ2.png)

우리는 GCP를 이용해서 리액트 + node 프로젝트를 구현한 적 있다.
따라가기 급급해서 어떻게 진행한건지 이해를 잘 못했었는데, 이제는 정리해보려한다.

### GCP SQL
GCP의 프로젝트를 하나 생성해서 SQL서비스를 이용했다.
인스턴스를 만들어 공간을 빌리고 데이터베이스를 세팅했다. 
이는 그야말로 DB를 담당하는 놈이라고 생각하면된다.

### GCP Artifact Registry
이 곳은 우리의 back서버 파일을 저장하는 저장소의 역할을 한다.
원래는 빈공간인데, 우리가 제작한 dockerfile을 활용해서 환경을 세팅한다.
또 함께 올린 server파일을 실행시켜서 그야말로 *서버가 작동하는 공간*을 만드는 셈이다.

### GCP Cloud run
우리가 올린 저장소(Artifact Registry)의 서버를 실행하는 기능을 한다.
이로인해 주소(선생님은 api라고 표현하셨다)를 딸 수 있게된다.


---



## 인스턴스만들기

SQL 인스턴스만들기 - 공간빌리기
엔터프라이즈 / 샌드박스 / 인스턴스 아이디와 비밀번호 맞추기 (복잡성 요구) / 아이오와  
	구성옵션표시: 공유코어 머신 CPU1개 / HDD / 10GB / 저장용량자동증가 설정해지 /  공개비공개 모두 선택 / 모두에게 공개하려면(0.0.0.0/0)을 추가해주기(이름은아무거나) / 자동일일백업 해제하기 


### 만들고 난 뒤에 무얼해야하는가?

1. 데이터베이스에 데이터베이스 만들기
2. 사용자에 가서 사용자 있는지 확인하기

### 이후

연결에 공개아이피주소가 나와있고
네트워킹에 들어가면 네트워크 추가 등을 할 수 있다


---


nextjs는 api폴더에서 알아서 하지만, 그게 안되는 순수리액트나 자바스크립트..이런걸 쓰려면
인설트, 셀렉트 등등을 하는 server파일을 만들어야한다
만들고 이걸 실행할라면 절차가 필요하다

1.   docker파일과 server파일이 있다는전제하에
2. artifact Registy에서 저장소 만드는데 리전만 정확히 맞춰주면된다
3. 만들어진 저장소를 체크하고 설정안내 - 허가메시지를 복사한다
4. 클라우드 쉘에서 허가메시지를 넣어서 허가를 받고.
5. 도커파일이랑 서버파일을 가져와서 mkdir로 폴더하나 만든다음에 거기에 업로드한다
	서버파일이랑 도커파일말이야
	 어디에 업로드할지도 정확히 선택한다
6. 이제 서버파일이랑 도커파일을 내 저장소가 가지고있겠네.
7. cloud run에서 이제 내 저장소에있는 걸가지고 api를 만들어달라고해야한다.
8. 컨테이너 배포 
	기존 컨테이너 이미지에서 버전 1개 배포
	이미지 url선택해주기(아까 도커 푸시했으니까 뜬다)
	이름 적당히 고쳐주기 - 이게 바로 api주소가 되고
	리전은 꼭 맞춰주고
	엔드포인트가 나오는데 이게 바로 내 api인증키다. 
	인증되지않은 호출 허용하기 설정
	컨테이너, 볼륨, 네트워킨, 보안탭에 들어가서 *변수 및 보안 파일* 여기다가 내 환경변수 다 넣어주기
	마지막쪽에 *Cloud SQL연결을 반드시 눌러서 내 인스턴스랑 연결*  해야한다. 

이렇게 하면 api를 발급받을 수 있다.

---

